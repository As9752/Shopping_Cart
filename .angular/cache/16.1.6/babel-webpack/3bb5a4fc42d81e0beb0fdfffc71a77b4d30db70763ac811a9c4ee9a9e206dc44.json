{"ast":null,"code":"import { BehaviorSubject } from 'rxjs/internal/BehaviorSubject';\nimport { map } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../product/product.service\";\nexport class CartService {\n  getCart() {\n    return [...this.cart.items];\n  }\n  getFromStorage() {\n    const cartFromStorage = sessionStorage.getItem('cart');\n    if (cartFromStorage) {\n      this.cart = JSON.parse(cartFromStorage);\n      return this.cart;\n    }\n    return this.cart;\n  }\n  constructor(productSvc) {\n    this.productSvc = productSvc;\n    // private cart: Product[] = [];\n    // private cartItemCount = new BehaviorSubject(0);\n    // addToCart(product: Product): void {\n    //   this.cart.push(product);\n    //   this.cartItemCount.next(this.cart.length);\n    // }\n    // getCartItemCount(): BehaviorSubject<number> {\n    //   return this.cartItemCount;\n    // }\n    // getFromStorage(){\n    //   const cartFromStorage = sessionStorage.getItem('cart');\n    //   if(cartFromStorage){\n    //     this.cart = JSON.parse(cartFromStorage);\n    //     return this.cart;\n    //   }\n    //   return this.cart;\n    // }\n    // constructor() { }\n    // setToStorage(){\n    //   sessionStorage.setItem('cart', JSON.stringify(this.cart));\n    // }\n    this.cart = {\n      total: 0,\n      items: []\n    };\n    this.cart$ = new BehaviorSubject(this.getFromStorage());\n  }\n  setToStorage() {\n    sessionStorage.setItem('cart', JSON.stringify(this.cart));\n  }\n  addToCart(product) {\n    this.cart.items = [...this.cart.items, product];\n    this.cart.total = this.cart.items.reduce((acc, item) => item.price + acc, 0);\n    this.setToStorage();\n    this.cart$.next(this.cart);\n  }\n  getCartItemCount() {\n    return this.cart$.pipe(map(cart => cart.total));\n  }\n  deleteItemFromCart(product) {}\n  ngOnInit() {}\n}\nCartService.ɵfac = function CartService_Factory(t) {\n  return new (t || CartService)(i0.ɵɵinject(i1.ProductService));\n};\nCartService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: CartService,\n  factory: CartService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"names":["BehaviorSubject","map","CartService","getCart","cart","items","getFromStorage","cartFromStorage","sessionStorage","getItem","JSON","parse","constructor","productSvc","total","cart$","setToStorage","setItem","stringify","addToCart","product","reduce","acc","item","price","next","getCartItemCount","pipe","deleteItemFromCart","ngOnInit","i0","ɵɵinject","i1","ProductService","factory","ɵfac","providedIn"],"sources":["/Users/ashishkloudspot/Downloads/Shopping_Cart/src/app/cart/cart.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { Product } from '../model/product';\nimport { BehaviorSubject } from 'rxjs/internal/BehaviorSubject';\nimport { Observable, map } from 'rxjs';\nimport { ProductService } from '../product/product.service';\n\ntype Cart = {\n  total: number;\n\n  items: Product[];\n};\n@Injectable({\n  providedIn: 'root',\n})\nexport class CartService {\n\n  // private cart: Product[] = [];\n  // private cartItemCount = new BehaviorSubject(0);\n\n  // addToCart(product: Product): void {\n  //   this.cart.push(product);\n  //   this.cartItemCount.next(this.cart.length);\n  // }\n\n  // getCartItemCount(): BehaviorSubject<number> {\n  //   return this.cartItemCount;\n  // }\n\n  // getFromStorage(){\n  //   const cartFromStorage = sessionStorage.getItem('cart');\n\n  //   if(cartFromStorage){\n  //     this.cart = JSON.parse(cartFromStorage);\n  //     return this.cart;\n  //   }\n  //   return this.cart;\n  // }\n\n  // constructor() { }\n\n  // setToStorage(){\n  //   sessionStorage.setItem('cart', JSON.stringify(this.cart));\n  // }\n\n  cart: Cart = { total: 0, items: [] };\n\n  cart$: BehaviorSubject<Cart> = new BehaviorSubject(this.getFromStorage());\n\n  getCart(): Product[] {\n    return [...this.cart.items];\n  }\n\n  getFromStorage() {\n    const cartFromStorage = sessionStorage.getItem('cart');\n\n    if (cartFromStorage) {\n      this.cart = JSON.parse(cartFromStorage);\n\n      return this.cart;\n    }\n\n    return this.cart;\n  }\n\n  constructor(private productSvc:ProductService) {}\n\n  setToStorage() {\n    sessionStorage.setItem('cart', JSON.stringify(this.cart));\n  }\n\n  addToCart(product: Product) {\n    this.cart.items = [...this.cart.items, product];\n\n    this.cart.total = this.cart.items.reduce(\n      (acc, item) => item.price + acc,\n      0\n    );\n\n    this.setToStorage();\n\n    this.cart$.next(this.cart);\n  }\n  getCartItemCount(): Observable<number> {\n    return this.cart$.pipe(map((cart) => cart.total));\n  }\n\n  deleteItemFromCart(product:Product)\n  {\n    \n  }\n  ngOnInit()\n  {\n    \n  }\n}\n"],"mappings":"AAEA,SAASA,eAAe,QAAQ,+BAA+B;AAC/D,SAAqBC,GAAG,QAAQ,MAAM;;;AAWtC,OAAM,MAAOC,WAAW;EAkCtBC,OAAOA,CAAA;IACL,OAAO,CAAC,GAAG,IAAI,CAACC,IAAI,CAACC,KAAK,CAAC;EAC7B;EAEAC,cAAcA,CAAA;IACZ,MAAMC,eAAe,GAAGC,cAAc,CAACC,OAAO,CAAC,MAAM,CAAC;IAEtD,IAAIF,eAAe,EAAE;MACnB,IAAI,CAACH,IAAI,GAAGM,IAAI,CAACC,KAAK,CAACJ,eAAe,CAAC;MAEvC,OAAO,IAAI,CAACH,IAAI;;IAGlB,OAAO,IAAI,CAACA,IAAI;EAClB;EAEAQ,YAAoBC,UAAyB;IAAzB,KAAAA,UAAU,GAAVA,UAAU;IAhD9B;IACA;IAEA;IACA;IACA;IACA;IAEA;IACA;IACA;IAEA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IAEA;IAEA;IACA;IACA;IAEA,KAAAT,IAAI,GAAS;MAAEU,KAAK,EAAE,CAAC;MAAET,KAAK,EAAE;IAAE,CAAE;IAEpC,KAAAU,KAAK,GAA0B,IAAIf,eAAe,CAAC,IAAI,CAACM,cAAc,EAAE,CAAC;EAkBzB;EAEhDU,YAAYA,CAAA;IACVR,cAAc,CAACS,OAAO,CAAC,MAAM,EAAEP,IAAI,CAACQ,SAAS,CAAC,IAAI,CAACd,IAAI,CAAC,CAAC;EAC3D;EAEAe,SAASA,CAACC,OAAgB;IACxB,IAAI,CAAChB,IAAI,CAACC,KAAK,GAAG,CAAC,GAAG,IAAI,CAACD,IAAI,CAACC,KAAK,EAAEe,OAAO,CAAC;IAE/C,IAAI,CAAChB,IAAI,CAACU,KAAK,GAAG,IAAI,CAACV,IAAI,CAACC,KAAK,CAACgB,MAAM,CACtC,CAACC,GAAG,EAAEC,IAAI,KAAKA,IAAI,CAACC,KAAK,GAAGF,GAAG,EAC/B,CAAC,CACF;IAED,IAAI,CAACN,YAAY,EAAE;IAEnB,IAAI,CAACD,KAAK,CAACU,IAAI,CAAC,IAAI,CAACrB,IAAI,CAAC;EAC5B;EACAsB,gBAAgBA,CAAA;IACd,OAAO,IAAI,CAACX,KAAK,CAACY,IAAI,CAAC1B,GAAG,CAAEG,IAAI,IAAKA,IAAI,CAACU,KAAK,CAAC,CAAC;EACnD;EAEAc,kBAAkBA,CAACR,OAAe,GAGlC;EACAS,QAAQA,CAAA,GAGR;;AA/EW3B,WAAW,C;mBAAXA,WAAW,EAAA4B,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,cAAA;AAAA;AAAX/B,WAAW,C;SAAXA,WAAW;EAAAgC,OAAA,EAAXhC,WAAW,CAAAiC,IAAA;EAAAC,UAAA,EAFV;AAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}